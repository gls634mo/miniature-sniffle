# Изменения в боте для розыгрышей

## Что было убрано:

### Из команды `/giveaway`:
- ❌ Параметр `уровень` - проверка уровня пользователя
- ❌ Параметр `войс-онлайн` - проверка часов в войсе
- ❌ Параметр `сообщений` - проверка количества сообщений

### Из схемы базы данных:
- ❌ Поле `level` 
- ❌ Поле `hours`
- ❌ Поле `messages`

### Из ClientReady.js:
- ❌ Функция `banner_update()` - обновление баннера сервера
- ❌ Функция `chechDonate()` - проверка донат ролей
- ❌ Все связанные setInterval для баннера и донатов
- ❌ Импорты canvas, registerFont
- ❌ Импорт DonateRolesSchema

### Из UtilsInteractions.js:
- ❌ Проверки на `giveaway.level > doc.lvl`
- ❌ Проверки на `giveaway.messages > doc.message`
- ❌ Проверки на `giveaway.hours > doc.hours`
- ❌ Зависимость от `client.manager.get()`

## Что осталось:

### ✅ Основные функции розыгрышей:
- Создание розыгрышей с призом и длительностью
- Выбор количества победителей
- Автоматическое завершение розыгрышей
- Перевыбор победителей (reroll)
- Участие/выход из розыгрыша

### ✅ Проверка на войс (опционально):
- Параметр `войс` - требование находиться в голосовом канале
- Проверка `giveaway.voice && !interaction.member.voice.channel`

### ✅ Административные функции:
- Команда доступна только администраторам
- Перевыбор победителей только для администраторов

## Новые команды:

### `/reroll`
- ✅ Перевыбор победителей завершенного розыгрыша
- Параметр: `сообщение` (ID сообщения розыгрыша)
- Только для администраторов
- Исправлен алгоритм рандомного выбора (без повторов)

## Улучшения безопасности:

### Статус бота:
- ✅ Установлен статус DND (Do Not Disturb)
- ✅ Убраны кнопки перевыбора для обычных пользователей
- ✅ Все команды доступны только администраторам

### Исправления алгоритма:
- ✅ Исправлен рандомный выбор победителей (исключены повторы)
- ✅ Улучшена безопасность перевыбора победителей

## Новые файлы:

- `start.sh` - улучшенный скрипт управления ботом
- `config.example.js` - пример конфигурации
- `.gitignore` - исключения для git
- `CHANGES.md` - этот файл с описанием изменений
- `SlashCommands/Reroll.js` - команда перевыбора

## Структура проекта:

```
miniature-sniffle/
├── Events/
│   ├── Client/
│   │   ├── ClientReady.js
│   │   └── ChatInputCommands.js
│   └── interactions/
│       └── UtilsInteractions.js
├── Models/
│   └── GiveawaySchema.js
├── SlashCommands/
│   ├── Giveaway.js
│   └── Reroll.js
├── config.js
├── config.example.js
├── index.js
├── package.json
├── start.sh
└── README.md
```